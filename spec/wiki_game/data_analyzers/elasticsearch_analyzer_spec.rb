# frozen_string_literal: true
require 'wiki_game/data_analyzers/elasticsearch_analyzer'

RSpec.describe WikiGame::DataAnalyzers::ElasticsearchAnalyzer do
  let(:search) { described_class.new }
  let(:page_titles_from_benjamin_franklin) do
    ["111th Infantry Regiment (United States)", "1776 (film)", "1776 (musical)", "1787 Constitutional Convention", "A Dissertation on Liberty and Necessity, Pleasure and Pain", "Aaron V. Brown", "Abolitionism", "Abolitionism in the United States", "Abraham Baldwin", "Abraham Clark", "Abraham Lincoln", "Adam Ferguson", "Adam Smith", "Adamantios Korais", "Adoption of the Gregorian calendar", "Advice to a Friend on Choosing a Mistress", "Aether theories", "Age of Enlightenment", "Albany Congress", "Albany Plan", "Albert A. Michelson", "Albert Gallatin", "Albert S. Burleson", "Albert Vincent Casey", "Alessandro Volta", "Alexander Dallas Bache", "Alexander Graham Bell", "Alexander Hamilton", "Alexander Pope", "Alexander Randall", "Alexander Wedderburn, 1st Earl of Rosslyn", "Alice Freeman Palmer", "American Academy of Arts and Sciences", "American Enlightenment", "American Heritage (magazine)", "American National Biography", "American Philosophical Society", "American Revolution", "American Writers: A Journey Through History", "American football", "Amory Houghton", "Amos Kendall", "Amy Gutmann", "Andrew A. Harwood", "Andrew Bradford", "Andrew Carnegie", "Andrew Gregg Curtin", "Andrew Hamilton (lawyer)", "Andrew Jackson", "Andrew Kippis", "Andrew Oliver", "Andrzej Stanisław Załuski", "Anglicanism", "Animal magnetism", "Ann Smith Franklin", "Annapolis", "Anne-Robert-Jacques Turgot, Baron de Laune", "Anonymity", "Anonymously", "Anthony M. Frank", "Antoine Lavoisier", "Antonio Genovesi", "Aphorism", "Apprenticeship", "Archibald Spencer", "Archives", "Art and engraving on United States banknotes", "Arthur A. Hartman", "Arthur Cook (Pennsylvania)", "Arthur James (politician)", "Arthur K. Watson", "Arthur Lee (diplomat)", "Arthur Middleton", "Arthur Summerfield", "Articles of Confederation", "Asa Gray", "Associators", "Atheism in the Age of the Enlightenment", "Atlantic Ocean", "Augustin Dupré", "Augustus Saint-Gaudens", "BIBSYS", "Bachelor of Arts", "Bagatelles and Satires", "Balloon (aircraft)", "Banknote", "Barbados", "Baron d'Holbach", "Battles of Lexington and Concord", "Bellows", "Ben Franklin Stores", "Ben Franklin effect", "Ben Franklin in Paris", "Ben and Me", "Benito Jerónimo Feijóo y Montenegro", "Benjamin F. Bailar", "Benjamin Franklin", "Benjamin Franklin's phonetic alphabet", "Benjamin Franklin (2002 film)", "Benjamin Franklin (Jouvenal)", "Benjamin Franklin (disambiguation)", "Benjamin Franklin (miniseries)", "Benjamin Franklin Bache (journalist)", "Benjamin Franklin Bridge", "Benjamin Franklin House", "Benjamin Franklin Institute of Technology", "Benjamin Franklin Medal (American Philosophical Society)", "Benjamin Franklin Medal (Franklin Institute)", "Benjamin Franklin Medal (Royal Society of Arts)", "Benjamin Franklin National Memorial", "Benjamin Franklin Parkway", "Benjamin Franklin Shibe", "Benjamin Franklin in popular culture", "Benjamin Harrison V", "Benjamin Rush", "Benjamin Thompson", "Benjamin West", "Benjamin Wilson (painter)", "Bequest", "Biblioteca Nacional de España", "Bibliothèque nationale de France", "Bifocals", "Bigamy", "Biografisch Portaal", "Biographical Directory of the United States Congress", "Blue plaque", "Board of Trade", "Book of Exodus", "Booker T. Washington", "Boston", "Boston Gazette", "Boston Latin School", "British America", "British Army", "British North America", "Bureau of Engraving and Printing", "Bureau of Public Affairs", "Bust (sculpture)", "Button Gwinnett", "C-SPAN", "C. Douglas Dillon", "CHESS magazine", "CMA CGM Benjamin Franklin", "CNNMoney", "Cabinet of the United States", "Caesar Rodney", "Café de la Régence", "Calendar (New Style) Act 1750", "Cambridge", "Cambridge University Press", "Camden, New Jersey", "Canada Post", "Capitalism", "Carl L. Becker", "Carl Van Doren", "Carter Braxton", "Cartesian doubt", "Catamaran", "Catherine the Great", "Catholic Church", "Cato's Letters", "Cave Johnson", "Centimetre–gram–second system of units", "Central London", "Cesare Beccaria", "Champ de Mars", "Chandlery", "Charge conservation", "Charles-Joseph Mathon de la Cour", "Charles A. Wickliffe", "Charles Biddle", "Charles Blagden", "Charles Carroll of Carrollton", "Charles Cotesworth Pinckney", "Charles Custis Harrison", "Charles E. Bohlen", "Charles Emory Smith", "Charles Hatchett", "Charles Hutton", "Charles III of Spain", "Charles I of England", "Charles J. Faulkner", "Charles Janeway Stillé", "Charles Pinckney (governor)", "Charles Rivkin", "Charleston, South Carolina", "Charlotte Cushman", "Chastity", "Chess", "Christ Church Burial Ground", "Christiaan Huygens", "Christian prayer", "Church of England", "Civic virtue", "Civil liberties", "Claire Fagin", "Clapham Common", "Clara Barton", "Classical liberalism", "Classical period (music)", "Claude Adrien Helvétius", "Cleanliness", "Clinton Rossiter", "College of William & Mary", "Colonial Williamsburg", "Columbia University", "Commissioner", "Committee of Five", "Committee of Secret Correspondence", "Common-law marriage", "Congregationalist", "Congress of the Confederation", "Connecticut", "Constitutional Convention (United States)", "Constitutional Convention of 1787", "Constitutions of the Free-Masons", "Continental Army", "Continental Congress", "Cooling by Evaporation", "Copley Medal", "Corpuscular theory of light", "Cotton Mather", "Counter-Enlightenment", "Counterfeit", "County (United States)", "Court (royal)", "Court clerk", "Craig Roberts Stapleton", "Critical thinking", "Daniel Boone", "Daniel Carroll", "Daniel Goodwin (Penn)", "Daniel H. Hastings", "Daniel Webster", "Daniel of St. Thomas Jenifer", "David Brearly", "David Farragut", "David Hall (publisher)", "David Hume", "David K. E. Bruce", "David L. Lawrence", "David Lloyd (judge)", "David M. Key", "David Martin (artist)", "David Oswald Thomas", "David R. Porter", "David Redick", "David Vincent Hooper", "Daylight saving time", "Deborah Read", "Decision-making", "Decisional balance sheet", "Deflation", "Deism", "Delaware", "Delaware River", "Democracy", "Demography", "Denis Diderot", "Detroit Publishing Company", "Dick Thornburgh", "Dictionary of National Biography", "Diethyl ether", "Digital object identifier", "Divinity of Jesus", "Doctrine of the Trinity Act 1813", "Donald M. Dickinson", "Dowry", "Drew R. McCoy", "Dublin", "E. T. Klassen", "Early American currency", "Ebenezer Hazard", "Ecton, Northamptonshire", "Ed Rendell", "Edgar Allan Poe", "Edgar Fahs Smith", "Edict of Fontainebleau", "Edict of Versailles", "Edinburgh", "Edmund Burke", "Edmund F. Robertson", "Edmund Morgan (historian)", "Edward Biddle", "Edward Charles Howard", "Edward Delaval", "Edward Follansbee Noyes", "Edward Gibbon", "Edward Livingston", "Edward MacDowell", "Edward Martin (Pennsylvania politician)", "Edward Rutledge", "Edward Shippen", "Edward Waring", "Edwin Booth", "Edwin Sydney Stuart", "Egalitarian", "Eiffel Tower", "Elbridge Gerry", "Electric charge", "Electric shock", "Electricity", "Eli Whitney", "Elias Howe", "Elihu B. Washburne", "Elizabeth Timothy", "Emma Willard", "Empiricism", "Encyclopædia Britannica Eleventh Edition", "Encyclopédistes", "English Dissenters", "English coffeehouses in the 17th and 18th centuries", "Enlightened absolutism", "Enlightenment in Poland", "Enlightenment in Spain", "Erasmus Darwin", "Esmond Wright", "Essex Street Chapel", "Ethics", "Evan G. Galbraith", "Evaporation", "Everything You Know Is Wrong", "Experiments and Observations on Electricity", "Explorer-class container ship", "Ezra Stiles", "Falmouth, Cornwall", "Fart Proudly", "Federal government of the United States", "Felix Rohatyn", "Fides et Historia", "Find a Grave", "First Great Awakening", "Florence Earle Coates", "Founding Fathers of the United States", "Frances Willard (suffragist)", "France–United States relations", "Francis Bacon", "Francis Folger Franklin", "Francis Granger", "Francis Hopkinson", "Francis Hutcheson (philosopher)", "Francis Lewis", "Francis Lightfoot Lee", "Francis Parkman", "Francis R. Shunk", "Franco-American alliance", "Frank Comerford Walker", "Frank Harris Hitchcock", "Frank Hatton (U.S. politician)", "Franklin's electrostatic machine", "Franklin & Marshall College", "Franklin (disambiguation)", "Franklin Court", "Franklin D. Roosevelt", "Franklin Field", "Franklin Institute", "Franklin Templeton Investments", "Franklin and Marshall College", "Franklin half dollar", "Franklin stove", "Franklinia alatamaha", "Franz Mesmer", "François Quesnay", "Frederick Beasley", "Free market", "Freedom of religion", "Freedom of speech", "Freedom of the City", "Freemasonry", "French and Indian War", "French livre", "French ship Franklin (1797)", "Friedrich Christoph Schlosser", "Friedrich Heinrich Jacobi", "Friedrich Schiller", "Frugality", "Fugitive from justice", "Fur", "Gaetano Filangieri", "Gaylord Probasco Harnwell", "General Assembly of Unitarian and Free Christian Churches", "Genius", "Gentleman's club", "Georg Wilhelm Richmann", "George Atwood", "George B. Cortelyou", "George Bancroft", "George Bryan", "George Clymer", "George Howard Earle III", "George III of the United Kingdom", "George M. Leader", "George Mason", "George Peabody", "George Pocock (inventor)", "George Read (U.S. statesman)", "George Ross (delegate)", "George Shuckburgh-Evelyn", "George Taylor (delegate)", "George Vernon Hudson", "George Walton", "George Washington", "George Washington Carver", "George Westinghouse", "George Whitefield", "George William McClelland", "George Wolf", "George Wythe", "George von Lengerke Meyer", "Georges-Louis Leclerc, Comte de Buffon", "Georgia (U.S. state)", "German language", "Gideon Granger", "Gifford Pinchot", "Gilbert Stuart", "Glass harmonica", "Gordon S. Wood", "Gotthold Ephraim Lessing", "Gout", "Gouverneur Morris", "Governor of New Jersey", "Great Seal of the United States", "Ground (electricity)", "Grover Cleveland", "Gulf Stream", "Gunning Bedford Jr.", "H. W. Brands", "Halifax, Nova Scotia", "Hall of Fame for Great Americans", "Harmonica", "Harold Edward Stassen", "Harp", "Harriet Beecher Stowe", "Harry Stewart New", "Harvard", "Harvard Collection of Historical Scientific Instruments", "Harvard Hall", "Harvard Science Center", "Harvard University", "Haskalah", "Hawkeye Pierce", "Henry Cavendish", "Henry Clay", "Henry Clay Payne", "Henry David Thoreau", "Henry Home, Lord Kames", "Henry M. Hoyt", "Henry Steele Commager", "Henry Vethake", "Henry Wadsworth Longfellow", "Henry Ward Beecher", "Henry White (diplomat)", "Historical Society of Pennsylvania", "History (U.S. TV channel)", "History of American newspapers", "History of physics", "Honoré Gabriel Riqueti, comte de Mirabeau", "Horace Mann", "Horace Maynard", "Horace Porter", "Horatio King", "House of Commons of the United Kingdom", "Howard H. Leach", "Hubert Work", "Hugh Campbell Wallace", "Hugh Meredith", "Hugh Williamson", "Hugo Kołłątaj", "Human rights", "Human sexuality", "Humanism", "Humility", "Hutchinson Letters Affair", "IMDb", "Ignacy Krasicki", "Immanuel Kant", "Indentured servant", "Independent politician", "Indian removal", "Industry", "Infant baptism", "Integrated Authority File", "International Standard Book Number", "International Standard Name Identifier", "International slave trade", "Internet Archive", "Isaac Asimov", "Isaac Bickerstaff", "Isaac Newton", "Isaac Norris", "Isaac Norris (statesman)", "Israelites", "Istituto Centrale per il Catalogo Unico", "Italian language", "Ivy League", "J. Edward Day", "JSTOR", "Jacob Broom", "Jacob Collamer", "Jacques-Donatien Le Ray de Chaumont"]
  end

  before(:each) do
    search.delete_index
  end

  describe '#find_similar_page' do
    xit 'can find itself' do
      page_title = '111th Infantry Regiment (United States)'
      search.add_page(page_title)
      expect(search.find_similar_page(page_title)).to eq(page_title)
    end

    xit 'can find a similar page' do
      page_title = '111th Infantry Regiment (United States)'
      search.add_page(page_title)
      expect(search.find_similar_page('Infantry Regiment')).to eq(page_title)
    end

    xit 'cannot find a completely different page' do
      page_title = '111th Infantry Regiment (United States)'
      search.add_page(page_title)
      expect(search.find_similar_page('I am from Mexico')).to be_nil
    end
  end

  describe '#find_similar_pages' do
    xit 'return 5 most similar page titles when are many similar pages including the search phrase' do
      search.add_pages(page_titles_from_benjamin_franklin)
      page_title = 'American'
      expect(search.find_similar_pages(page_title, 5)).to match_array(['American Enlightenment', 'American Philosophical Society', 'American Heritage (magazine)', 'American football', 'Early American currency'])
    end

    xit 'return 5 most similar page titles when are not any similar pages including the search phrase' do
      search.add_pages(page_titles_from_benjamin_franklin)
      page_title = 'Austria-Hungary'
      expect(search.find_similar_pages(page_title, 5)).to be_empty
    end
  end
end
